(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,88286,e=>{"use strict";var t=e.i(43476),s=e.i(71645);function l(){let[e,l]=(0,s.useState)("idle"),[a,i]=(0,s.useState)(0),[n,d]=(0,s.useState)(0),[c,o]=(0,s.useState)(10),[x,u]=(0,s.useState)(0),[m,g]=(0,s.useState)(0),[p,h]=(0,s.useState)(30),[v,b]=(0,s.useState)(30),y=(0,s.useRef)(!1),[f,j]=(0,s.useState)(!1),[N,w]=(0,s.useState)([{x:1,y:1}]),[k,S]=(0,s.useState)("RIGHT"),[L,T]=(0,s.useState)({x:2,y:2}),C=e=>{let t=Math.floor(e/2);return{width:4+t,height:4+t+e%2}},[G,O]=(0,s.useState)(4),[R,V]=(0,s.useState)(4),U=(0,s.useRef)("RIGHT"),A=(0,s.useRef)([{x:1,y:1}]);(0,s.useEffect)(()=>{A.current=N},[N]),(0,s.useEffect)(()=>{U.current=k},[k]);let[E,P]=(0,s.useState)("game"),[$,B]=(0,s.useState)(1),[I,q]=(0,s.useState)(0),[_,M]=(0,s.useState)([]),[z,D]=(0,s.useState)([{id:"appleValue",name:"Valeur des Pommes",description:"Augmente la valeur de chaque pomme rÃ©coltÃ©e",baseCost:10,level:0,maxLevel:20,unlocked:!0,position:{x:1,y:1},effect:()=>{}},{id:"healthBonus",name:"Points de Vie",description:"Augmente les PV de dÃ©part du serpent",baseCost:10,level:0,maxLevel:20,unlocked:!0,position:{x:1,y:3},effect:()=>{}},{id:"timeBonus",name:"Bonus Temps",description:"+2 secondes par partie",baseCost:50,level:0,maxLevel:10,unlocked:!1,requiredLevel:"appleValue",requiredLevelValue:3,position:{x:-1,y:1},effect:()=>{}},{id:"gridSize",name:"Taille de la Grille",description:"Agrandit le terrain de jeu",baseCost:25,level:0,maxLevel:6,unlocked:!1,requiredLevel:"appleValue",requiredLevelValue:3,position:{x:3,y:1},effect:()=>{}}]);(0,s.useEffect)(()=>{j(!0),T(Z([{x:1,y:1}])||{x:2,y:2})},[]);let H=(0,s.useCallback)(e=>e.map(t=>{if(!t.unlocked&&t.requiredLevel&&t.requiredLevelValue){let s=e.find(e=>e.id===t.requiredLevel);if(s&&s.level>=t.requiredLevelValue)return{...t,unlocked:!0}}return t}),[]),F=(0,s.useCallback)((e,t)=>Math.floor(e*Math.pow(1.5,t)),[]),W=(0,s.useCallback)(t=>{D(s=>{let r=s.find(e=>e.id===t);return!r||r.level>=r.maxLevel||!r.unlocked||a<F(r.baseCost,r.level)?s:H(s.map(s=>{if(s.id===t){let r=s.level+1;if("appleValue"===t)B(1+r);else if("healthBonus"===t)u(r);else if("gridSize"===t){let t=C(r);O(t.width),V(t.height),"playing"===e&&(l("idle"),P("game"))}else"timeBonus"===t&&q(2*r);return{...s,level:r}}return s}))});let s=z.find(e=>e.id===t);if(s){let e=F(s.baseCost,s.level);i(t=>Math.max(0,t-e))}},[a,F,e,H]),J=(0,s.useCallback)(()=>{let e=z.map(e=>({id:e.id,name:e.name,description:e.description,baseCost:e.baseCost,level:e.level,maxLevel:e.maxLevel,unlocked:e.unlocked,requiredLevel:e.requiredLevel,requiredLevelValue:e.requiredLevelValue,position:e.position,effect:()=>{}}));M(e);let t=new Blob([JSON.stringify({savedUpgrades:e,gameState:{appleValue:$,healthBonus:x,timeBonus:I,gridWidth:G,gridHeight:R,totalPoints:a,highScore:m},timestamp:new Date().toISOString()},null,2)],{type:"application/json"}),s=URL.createObjectURL(t),l=document.createElement("a");l.href=s,l.download=`snake_idle_upgrades_${Date.now()}.json`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(s)},[z,$,I,G,R,a,m]),K=(0,s.useCallback)(e=>{let t=e.target.files?.[0];if(!t)return;let s=new FileReader;s.onload=e=>{try{let t=JSON.parse(e.target?.result);t.savedUpgrades&&Array.isArray(t.savedUpgrades)&&(M(t.savedUpgrades),t.gameState&&(B(t.gameState.appleValue||1),u(t.gameState.healthBonus||0),q(t.gameState.timeBonus||0),O(t.gameState.gridWidth||4),V(t.gameState.gridHeight||4),g(t.gameState.highScore||0)))}catch(e){console.error("Erreur lors du chargement des amÃ©liorations:",e),alert("Erreur: Le fichier de sauvegarde est invalide")}},s.readAsText(t)},[]),Q=(0,s.useCallback)(()=>{0===_.length?alert("Aucune amÃ©lioration sauvegardÃ©e Ã  appliquer"):(B(1),u(0),q(0),O(4),V(4),D(z.map(e=>{let t=_.find(t=>t.id===e.id);if(t){let s=t.level-e.level;if("appleValue"===e.id)B(e=>e+s);else if("healthBonus"===e.id)u(e=>e+s);else if("timeBonus"===e.id)q(e=>e+2*t.level);else if("gridSize"===e.id){let e=C(t.level);O(e.width),V(e.height)}return t}return e})),M([]),alert("AmÃ©liorations appliquÃ©es avec succÃ¨s!"))},[_,z]),Z=(0,s.useCallback)(e=>{let t=[];for(let s=0;s<G;s++)for(let l=0;l<R;l++)e.some(e=>e.x===s&&e.y===l)||t.push({x:s,y:l});if(0===t.length)return null;let s=Math.floor(Math.random()*t.length);return t[s]},[G,R]),X=()=>{let e=[{x:1,y:1}];A.current=e,U.current="RIGHT",y.current=!1,w(e),S("RIGHT"),T((f?Z(e):{x:2,y:2})||{x:2,y:2}),d(0),o(10+x),h(v+I),l("playing")},Y=(0,s.useCallback)(()=>{if("playing"!==e)return;let t=[...A.current],s={...t[0]};switch(U.current){case"UP":s.y-=1;break;case"DOWN":s.y+=1;break;case"LEFT":s.x-=1;break;case"RIGHT":s.x+=1}if(s.x<0||s.x>=G||s.y<0||s.y>=R||(t.length>1?t.slice(0,-1):t).some(e=>e.x===s.x&&e.y===s.y))return void l("gameOver");if(t.unshift(s),s.x===L.x&&s.y===L.y){d(e=>e+$),o(e=>{let t=e-1;return t<=0&&l("gameOver"),t});let e=Z(t);if(null===e)return void l("gameOver");T(e)}else t.pop();A.current=t,w(t)},[L,e,Z,G,R,$]);(0,s.useEffect)(()=>{"gameOver"!==e||y.current||(i(e=>e+n),n>m&&g(n),y.current=!0)},[e,n,m]),(0,s.useEffect)(()=>{if("playing"!==e)return;let t=setInterval(Y,500);return()=>clearInterval(t)},[e,Y]),(0,s.useEffect)(()=>{if("playing"!==e)return;let t=setInterval(()=>{h(e=>e<=1?(l("gameOver"),0):e-1)},1e3);return()=>clearInterval(t)},[e]);let ee=(0,s.useCallback)(e=>{let t=[...A.current];if(t.length<=2)return!1;let s={...t[0]};switch(e){case"UP":s.y-=1;break;case"DOWN":s.y+=1;break;case"LEFT":s.x-=1;break;case"RIGHT":s.x+=1}return(t.length>1?t.slice(1,-1):[]).some(e=>e.x===s.x&&e.y===s.y)},[]);return((0,s.useEffect)(()=>{let t=t=>{if("playing"!==e)return;["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(t.key)&&t.preventDefault();let s=null;switch(t.key){case"ArrowUp":case"z":case"Z":s="UP";break;case"ArrowDown":case"s":case"S":s="DOWN";break;case"ArrowLeft":case"q":case"Q":s="LEFT";break;case"ArrowRight":case"d":case"D":s="RIGHT"}s&&("UP"===s&&"DOWN"===U.current||"DOWN"===s&&"UP"===U.current||"LEFT"===s&&"RIGHT"===U.current||"RIGHT"===s&&"LEFT"===U.current||ee(s)||(U.current=s,S(s)))};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[e,ee]),f)?(0,t.jsxs)("div",{className:"flex flex-col items-center min-h-screen",children:[(0,t.jsxs)("div",{className:"w-full max-w-4xl mb-6",children:[(0,t.jsx)("h1",{className:"text-4xl font-bold text-center mb-4",children:"Snake Idle"}),(0,t.jsx)("div",{className:"flex justify-center mb-6",children:(0,t.jsxs)("div",{className:"bg-gray-800 p-1 rounded-lg",children:[(0,t.jsx)("button",{onClick:()=>P("game"),className:`px-6 py-2 rounded-md font-semibold transition-colors ${"game"===E?"bg-green-600 text-white":"text-gray-400 hover:text-white hover:bg-gray-700"}`,children:"ðŸŽ® JEU"}),(0,t.jsx)("button",{onClick:()=>P("upgrades"),className:`px-6 py-2 rounded-md font-semibold transition-colors ml-2 ${"upgrades"===E?"bg-purple-600 text-white":"text-gray-400 hover:text-white hover:bg-gray-700"}`,children:"ðŸš€ AMÃ‰LIORATIONS"})]})}),(0,t.jsx)("div",{className:"text-center",children:(0,t.jsxs)("div",{className:"grid grid-cols-6 gap-4 mb-4",children:[(0,t.jsxs)("div",{className:"bg-gray-800 p-4 rounded-lg",children:[(0,t.jsx)("div",{className:"text-sm text-gray-400",children:"PV"}),(0,t.jsxs)("div",{className:`text-2xl font-bold ${c<=5?"text-red-500":c<=10?"text-yellow-400":"text-red-400"}`,children:["â¤ï¸ ",c]})]}),(0,t.jsxs)("div",{className:"bg-gray-800 p-4 rounded-lg",children:[(0,t.jsx)("div",{className:"text-sm text-gray-400",children:"Points actuels"}),(0,t.jsx)("div",{className:"text-2xl font-bold text-green-400",children:n})]}),(0,t.jsxs)("div",{className:"bg-gray-800 p-4 rounded-lg",children:[(0,t.jsx)("div",{className:"text-sm text-gray-400",children:"Total accumulÃ©"}),(0,t.jsx)("div",{className:"text-2xl font-bold text-yellow-400",children:a})]}),(0,t.jsxs)("div",{className:"bg-gray-800 p-4 rounded-lg",children:[(0,t.jsx)("div",{className:"text-sm text-gray-400",children:"Meilleur score"}),(0,t.jsx)("div",{className:"text-2xl font-bold text-purple-400",children:m})]}),(0,t.jsxs)("div",{className:`bg-gray-800 p-4 rounded-lg ${p<=10?"border-2 border-red-500":""}`,children:[(0,t.jsx)("div",{className:"text-sm text-gray-400",children:"Temps restant"}),(0,t.jsxs)("div",{className:`text-2xl font-bold ${p<=10?"text-red-400":"text-blue-400"}`,children:[p,"s"]})]}),(0,t.jsxs)("div",{className:"bg-gray-800 p-4 rounded-lg",children:[(0,t.jsx)("div",{className:"text-sm text-gray-400",children:"Valeur pomme"}),(0,t.jsxs)("div",{className:"text-2xl font-bold text-red-400",children:["+",$]})]})]})})]}),"game"===E&&(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{className:"relative bg-gray-800 p-4 rounded-lg shadow-2xl",children:[(0,t.jsxs)("div",{className:"relative grid bg-gray-700 border-4 border-gray-600",style:{gridTemplateColumns:`repeat(${G}, 80px)`,gridTemplateRows:`repeat(${R}, 80px)`},children:[Array.from({length:G*R}).map((e,s)=>(0,t.jsx)("div",{className:"border border-gray-600 bg-gray-750"},`cell-${s}`)),(0,t.jsxs)("div",{className:"absolute flex items-center justify-center",style:{left:`${80*L.x}px`,top:`${80*L.y}px`,width:"80px",height:"80px"},children:[(0,t.jsx)("img",{src:"/Graphics/apple.png",alt:"Food",className:"w-12 h-12",onError:e=>{console.error("Error loading apple.png"),e.currentTarget.style.display="none"}}),(0,t.jsx)("div",{className:"w-8 h-8 bg-red-500 rounded-full",style:{display:"none"},id:"apple-fallback"})]}),N.map((e,s)=>(0,t.jsx)("div",{className:"absolute flex items-center justify-center",style:{left:`${80*e.x}px`,top:`${80*e.y}px`,width:"80px",height:"80px"},children:(0,t.jsx)("img",{src:((e,t)=>{if(0===t)switch(k){case"UP":return"/Graphics/head_up.png";case"DOWN":return"/Graphics/head_down.png";case"LEFT":return"/Graphics/head_left.png";case"RIGHT":return"/Graphics/head_right.png"}else if(t===N.length-1){let s=N[t-1];if(s.x<e.x)return"/Graphics/tail_right.png";if(s.x>e.x)return"/Graphics/tail_left.png";if(s.y<e.y)return"/Graphics/tail_down.png";if(s.y>e.y)return"/Graphics/tail_up.png"}else{let s=N[t-1],l=N[t+1];if(s.x===l.x)return"/Graphics/body_vertical.png";if(s.y===l.y)return"/Graphics/body_horizontal.png";if(s.x<e.x&&l.y<e.y||s.y<e.y&&l.x<e.x)return"/Graphics/body_topleft.png";if(s.x>e.x&&l.y<e.y||s.y<e.y&&l.x>e.x)return"/Graphics/body_topright.png";if(s.x<e.x&&l.y>e.y||s.y>e.y&&l.x<e.x)return"/Graphics/body_bottomleft.png";if(s.x>e.x&&l.y>e.y||s.y>e.y&&l.x>e.x)return"/Graphics/body_bottomright.png"}return"/Graphics/body_horizontal.png"})(e,s),alt:`Snake segment ${s}`,className:"w-16 h-16"})},`snake-${s}`))]}),"gameOver"===e&&(0,t.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-75 flex items-center justify-center rounded-lg",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h2",{className:"text-3xl font-bold mb-2 text-red-400",children:0===p?"Temps Ã©coulÃ©!":n===G*R-1?"Parfait! Tableau rempli!":"Game Over!"}),(0,t.jsxs)("p",{className:"text-lg mb-4",children:["Score: ",n]}),(0,t.jsxs)("p",{className:"text-sm text-gray-300 mb-4",children:["+",n," points ajoutÃ©s au total!"]}),0===p&&(0,t.jsx)("p",{className:"text-sm text-blue-300 mb-4",children:"â° Les 30 secondes sont terminÃ©es"}),n===G*R-1&&(0,t.jsx)("p",{className:"text-sm text-green-300 mb-4",children:"ðŸŽ‰ Vous avez rempli tout le tableau!"})]})})]})}),"upgrades"===E&&(0,t.jsx)(r,{upgrades:z,totalPoints:a,currentPoints:n,appleValue:$,gridWidth:G,gridHeight:R,timeBonus:I,onBuyUpgrade:W,onPlayGame:()=>{P("game"),("idle"===e||"gameOver"===e)&&X()},gameState:e,saveUpgrades:J,loadUpgrades:K,applySavedUpgrades:Q,savedUpgrades:_,healthBonus:x}),"game"===E&&(0,t.jsxs)("div",{className:"mt-6 text-center",children:["idle"===e&&(0,t.jsx)("button",{onClick:X,className:"bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg text-lg transition-colors",children:"Commencer Ã  jouer"}),"gameOver"===e&&(0,t.jsx)("button",{onClick:X,className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg text-lg transition-colors",children:"Rejouer"}),"playing"===e&&(0,t.jsx)("div",{className:"text-sm text-gray-400",children:"Utilisez les flÃ¨ches ou Z/Q/S/D pour contrÃ´ler le snake"})]}),"game"===E&&(0,t.jsxs)("div",{className:"mt-6 text-center text-sm text-gray-500 max-w-md",children:[(0,t.jsxs)("p",{className:"mb-2",children:["ðŸŽ® ",(0,t.jsx)("strong",{children:"Objectif:"})," Ramassez les pommes pour gagner des points"]}),(0,t.jsxs)("p",{className:"mb-2",children:["ðŸŽ ",(0,t.jsx)("strong",{children:"Points:"})," Chaque pomme vaut ",$," point",$>1?"s":""]}),(0,t.jsxs)("p",{className:"mb-2",children:["â° ",(0,t.jsx)("strong",{children:"Temps:"})," Vous avez 30 secondes par partie!"]}),(0,t.jsxs)("p",{className:"mb-2",children:["ðŸ’Ž ",(0,t.jsx)("strong",{children:"Idle:"})," Vos points sont conservÃ©s mÃªme aprÃ¨s la mort!"]}),(0,t.jsxs)("p",{children:["ðŸš€ ",(0,t.jsx)("strong",{children:"AmÃ©liorations:"})," Utilisez vos points pour dÃ©bloquer des bonus permanents!"]})]})]}):(0,t.jsx)("div",{className:"flex flex-col items-center justify-center min-h-screen",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h1",{className:"text-4xl font-bold mb-4",children:"Snake Idle"}),(0,t.jsx)("div",{className:"text-gray-400",children:"Chargement du jeu..."})]})})}function r({upgrades:e,totalPoints:s,currentPoints:l,appleValue:r,gridWidth:a,gridHeight:i,timeBonus:n,onBuyUpgrade:d,onPlayGame:c,gameState:o,saveUpgrades:x,loadUpgrades:u,applySavedUpgrades:m,savedUpgrades:g,healthBonus:p}){return(0,t.jsx)("div",{className:"w-full max-w-4xl mx-auto",children:(0,t.jsxs)("div",{className:"bg-gray-800 rounded-lg p-8 shadow-2xl",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-center mb-8 text-purple-400",children:"Arbre d'AmÃ©liorations"}),(0,t.jsx)("div",{className:"space-y-4 mb-16",children:e.map(l=>{let c=Math.floor(l.baseCost*Math.pow(1.5,l.level)),o=s>=c,x=l.level>=l.maxLevel;return(0,t.jsx)("div",{className:`p-4 rounded-lg border-2 transition-all cursor-pointer ${!l.unlocked?"bg-gray-900 border-gray-700 opacity-50":x?"bg-purple-900 border-purple-600":o?"bg-gray-800 border-green-600 hover:bg-gray-750":"bg-gray-800 border-gray-700 opacity-75"}`,onClick:()=>l.unlocked&&!x&&o&&d(l.id),children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,t.jsx)("div",{className:"text-lg font-bold text-gray-300",children:"appleValue"===l.id?"POMMES":"healthBonus"===l.id?"PV":"gridSize"===l.id?"GRILLE":"timeBonus"===l.id?"TEMPS":"BONUS"}),(0,t.jsx)("h3",{className:"font-bold text-white",children:l.name}),(0,t.jsxs)("div",{className:"text-sm text-gray-400",children:["Niv. ",l.level,"/",l.maxLevel]})]}),(0,t.jsx)("p",{className:"text-sm text-gray-400 mb-2",children:l.description}),!l.unlocked&&(0,t.jsxs)("div",{className:"text-sm text-yellow-400",children:["ðŸ”’ VerrouillÃ© - NÃ©cessite Niv.",l.requiredLevelValue," en"," ",e.find(e=>e.id===l.requiredLevel)?.name]}),(0,t.jsx)("div",{className:"flex items-center gap-4 mt-2",children:(0,t.jsxs)("div",{className:"text-sm font-semibold text-gray-300",children:["Actuellement:","appleValue"===l.id&&` +${r} points/pomme`,"healthBonus"===l.id&&` ${10+p} PV de d\xe9part`,"gridSize"===l.id&&` ${a}x${i}`,"timeBonus"===l.id&&` +${n}s par partie`]})})]}),(0,t.jsxs)("div",{className:"flex flex-col items-end ml-4",children:[l.unlocked&&!x&&(0,t.jsx)("div",{className:"text-lg font-bold",children:o?(0,t.jsxs)("span",{className:"text-green-400",children:[c," pts"]}):(0,t.jsxs)("span",{className:"text-red-400",children:[c," pts"]})}),x&&(0,t.jsx)("div",{className:"text-lg font-bold text-purple-400",children:"MAX"}),!l.unlocked&&(0,t.jsx)("div",{className:"text-lg font-bold text-yellow-400",children:"ðŸ”’"})]})]})},l.id)})}),(0,t.jsxs)("div",{className:"border-t border-gray-700 pt-6",children:[(0,t.jsx)("div",{className:"text-center",children:(0,t.jsx)("button",{onClick:c,className:`px-8 py-3 rounded-lg font-bold text-lg transition-colors ${"idle"===o||"gameOver"===o?"bg-green-600 hover:bg-green-700 text-white":"bg-blue-600 hover:bg-blue-700 text-white"}`,children:"idle"===o?"ðŸŽ® Commencer Ã  jouer":"gameOver"===o?"ðŸ”„ Rejouer":"ðŸŽ® Retourner au jeu"})}),(0,t.jsxs)("div",{className:"mt-6 grid grid-cols-3 gap-4 text-center",children:[(0,t.jsxs)("div",{className:"bg-gray-700 p-4 rounded-lg",children:[(0,t.jsx)("div",{className:"text-sm text-gray-400",children:"Valeur des pommes"}),(0,t.jsxs)("div",{className:"text-xl font-bold text-red-400",children:["+",r]})]}),(0,t.jsxs)("div",{className:"bg-gray-700 p-4 rounded-lg",children:[(0,t.jsx)("div",{className:"text-sm text-gray-400",children:"Bonus temps"}),(0,t.jsxs)("div",{className:"text-xl font-bold text-yellow-400",children:["+",n,"s"]})]}),(0,t.jsxs)("div",{className:"bg-gray-700 p-4 rounded-lg",children:[(0,t.jsx)("div",{className:"text-sm text-gray-400",children:"Taille de la grille"}),(0,t.jsxs)("div",{className:"text-xl font-bold text-blue-400",children:[a,"x",i]})]})]})]})]})})}e.s(["default",()=>l])}]);